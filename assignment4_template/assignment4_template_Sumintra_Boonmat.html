<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sumintra Boonmat">

<title>Has home ground advantage significantly affected match outcomes over the past decade of AFL (2014-2024)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="assignment4_template_Sumintra_Boonmat_files/libs/clipboard/clipboard.min.js"></script>
<script src="assignment4_template_Sumintra_Boonmat_files/libs/quarto-html/quarto.js"></script>
<script src="assignment4_template_Sumintra_Boonmat_files/libs/quarto-html/popper.min.js"></script>
<script src="assignment4_template_Sumintra_Boonmat_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="assignment4_template_Sumintra_Boonmat_files/libs/quarto-html/anchor.min.js"></script>
<link href="assignment4_template_Sumintra_Boonmat_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="assignment4_template_Sumintra_Boonmat_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="assignment4_template_Sumintra_Boonmat_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="assignment4_template_Sumintra_Boonmat_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="assignment4_template_Sumintra_Boonmat_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Has home ground advantage significantly affected match outcomes over the past decade of AFL (2014-2024)</h1>
<p class="subtitle lead">Assignment 4 ETC5512</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sumintra Boonmat </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Data and Documenting</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Blog post</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Behind the Scenes</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<section id="question1" class="level6">
<h6 class="anchored" data-anchor-id="question1"><strong>Question1:</strong></h6>
<p>Has home ground advantage significantly affected match outcomes over the past decade of AFL from 2014 to 2024.</p>
<p>I’m an AFL fan, and home advantage is often discussed but rarely quantified across time and teams. I am particularly interested in whether this effect varies by team or changes during finals.</p>
</section>
<section id="question2-what-data-will-you-be-using-to-answer-that-question-explain-why-this-data-is-suitable-for-the-task." class="level6">
<h6 class="anchored" data-anchor-id="question2-what-data-will-you-be-using-to-answer-that-question-explain-why-this-data-is-suitable-for-the-task."><strong>Question2: What data will you be using to answer that question? Explain why this data is suitable for the task.</strong></h6>
<p>To answer the question I use the dataset from <a href="https://afltables.com/afl/stats/biglists/bg3.txt" class="uri">AFL Tables</a> which contains historical records of every AFL game played since 1897 up to 2024 season in a plain-text format. Moreover, the dataset also includes variables which are all necessary for identifying home games and determining winners, such as:</p>
<ul>
<li><p>date, round, venue</p></li>
<li><p>home and away teams</p></li>
<li><p>final scores</p></li>
</ul>
<p>The dataset is published under the&nbsp;<strong>Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported (CC BY-NC-SA 3.0)</strong>&nbsp;licence, which allows reuse for educational and non-commercial purposes with proper attribution.</p>
</section>
<section id="question3-in-your-submission-include-comprehensive-details-about-your-data.-you-many-like-to-include-a-read-me-and-a-data-dictionary.-also-be-sure-to-make-clear-the-type-of-data-census-sample-experimental-any-data-limitations-data-privacy-or-any-ethical-considerations.-the-relevant-details-here-will-depend-on-the-data-you-choose-and-the-analysis-you-perform." class="level6">
<h6 class="anchored" data-anchor-id="question3-in-your-submission-include-comprehensive-details-about-your-data.-you-many-like-to-include-a-read-me-and-a-data-dictionary.-also-be-sure-to-make-clear-the-type-of-data-census-sample-experimental-any-data-limitations-data-privacy-or-any-ethical-considerations.-the-relevant-details-here-will-depend-on-the-data-you-choose-and-the-analysis-you-perform."><strong>Question3: In your submission, include comprehensive details about your data. You many like to include a read me and a data dictionary. Also be sure to make clear the type of data (census, sample, experimental), any data limitations, data privacy or any ethical considerations. The relevant details here will depend on the data you choose and the analysis you perform.</strong></h6>
<p><strong>Data Dictionary:</strong></p>
<ul>
<li>The data in this file contains the following variables:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   Variable   Type    Description                                               
   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;                                                     
 1 Date       Date    The date the match was played (e.g., 29-Mar-2014)         
 2 Year       Integer Year extracted from Date                                  
 3 Round      String  Round identifier (e.g., R1, R2, QF, GF)                   
 4 Home_Team  String  Name of the home team                                     
 5 Away_Team  String  Name of the away team                                     
 6 Home_Total Integer Home team total points                                    
 7 Away_Total Integer Away team total points                                    
 8 Venue      String  Stadium name (e.g., MCG, SCG, Marvel Stadium)             
 9 Home_Win   Binary  1 if home team won, 0 if not (NA if draw)                 
10 Is_Finals  Boolean TRUE if match is a final (based on Round), FALSE otherwise</code></pre>
</div>
</div>
<p><strong>README</strong></p>
<p>Author: Sumintra Boonmat</p>
<p>Date of Release: 20/06/2025</p>
<p>Description:</p>
<p>The following dataset supports an analysis of home ground advantage in the Australian Football League (AFL) over the 2014–2024 seasons. It includes structured match-level data derived from the publicly available AFL Tables.</p>
<p>Each record corresponds to a match and includes variables such as match date, round, home and away teams, scores, venue, and derived indicators such as match outcome (home win/loss) and whether the match occurred during the finals series. The dataset has been processed from a raw text format into a structured tabular format using R, with additional columns created for team performance and season analysis.</p>
<p>This data was used to investigate whether home ground advantage persists in modern AFL seasons, how it varies between teams, and whether it holds in finals matches.</p>
<p>The finals rounds in AFL are typically abbreviated as:</p>
<ul>
<li>EF - Elimination Final</li>
<li>QF - Qualifying Final</li>
<li>SF - Semi Final</li>
<li>PF - Preliminary Final</li>
<li>GF - Grand Final</li>
</ul>
<p>Data Source:</p>
<ul>
<li><a href="#0">AFL Tables</a> which maintained by Rohan Connolly and AFL statistics volunteers</li>
</ul>
<p>Data Type:</p>
<ul>
<li>Observational data from historical records</li>
</ul>
<p>Limitations:</p>
<ul>
<li>Rounds are abbreviated and finals rounds require classification (e.g., QF, GF).</li>
<li>Some venues may have changed names over time.</li>
</ul>
<p>License:</p>
<ul>
<li>Creative Commons Attribution-NonCommercial-ShareAlike 3.0 (CC BY-NC-SA 3.0)</li>
</ul>
</section>
<section id="question4-describe-the-steps-to-download-your-data-and-any-steps-to-process-your-data-for-your-analysis." class="level6">
<h6 class="anchored" data-anchor-id="question4-describe-the-steps-to-download-your-data-and-any-steps-to-process-your-data-for-your-analysis."><strong>Question4: Describe the steps to download your data and any steps to process your data for your analysis.</strong></h6>
<p>Steps to download the data and data cleaning:</p>
<ol type="1">
<li>Visit the website <a href="https://afltables.com/afl/afl_index.html">AFL Tables</a>.</li>
<li>Under the “Big List” section, click on&nbsp;<strong>“All games in chronological order”</strong>, which links to the file&nbsp;<code>bg3.txt</code>. This text file contains every AFL game since 1897.</li>
<li>Use R to download the file directly:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">"https://afltables.com/afl/stats/biglists/bg3.txt"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="st">"data/game_stats.txt"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Read the raw file and skip the first two non-data lines.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>raw_game_stats <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"data/game_stats.txt"</span>)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Parse the text into structured columns.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>parsed <span class="ot">&lt;-</span> <span class="fu">str_match</span>(raw_game_stats,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'^</span><span class="sc">\\</span><span class="st">s*"?(</span><span class="sc">\\</span><span class="st">d+)</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">s+(</span><span class="sc">\\</span><span class="st">d{1,2}-[A-Za-z]+-</span><span class="sc">\\</span><span class="st">d{4})</span><span class="sc">\\</span><span class="st">s+(R</span><span class="sc">\\</span><span class="st">d+|EF|QF|SF|PF|GF)</span><span class="sc">\\</span><span class="st">s+([A-Za-z .]+?)</span><span class="sc">\\</span><span class="st">s+(</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+)</span><span class="sc">\\</span><span class="st">s+([A-Za-z .]+?)</span><span class="sc">\\</span><span class="st">s+(</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">d+)</span><span class="sc">\\</span><span class="st">s+(.*?)"?$'</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>match_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(parsed[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(match_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Match_No"</span>, <span class="st">"Date"</span>, <span class="st">"Round"</span>, <span class="st">"Home_Team"</span>, <span class="st">"Home_Score"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Away_Team"</span>, <span class="st">"Away_Score"</span>, <span class="st">"Venue"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>match_df <span class="ot">&lt;-</span> match_df <span class="sc">|&gt;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), str_trim))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>Convert date to a proper format and filter matches between <strong>2014 and 2024</strong>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>match_df <span class="ot">&lt;-</span> match_df <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Date =</span> <span class="fu">dmy</span>(Date),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Year =</span> <span class="fu">year</span>(Date)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>match_recent <span class="ot">&lt;-</span> match_df <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Date) <span class="sc">&gt;=</span> <span class="dv">2014</span>, <span class="fu">year</span>(Date) <span class="sc">&lt;=</span> <span class="dv">2024</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li>Split the score strings into goals, behinds, and total points.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>split_score <span class="ot">&lt;-</span> <span class="cf">function</span>(score_str) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  parts <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(score_str, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="dv">3</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Goals =</span> <span class="fu">as.numeric</span>(parts[,<span class="dv">1</span>]),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Behinds =</span> <span class="fu">as.numeric</span>(parts[,<span class="dv">2</span>]),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total =</span> <span class="fu">as.numeric</span>(parts[,<span class="dv">3</span>])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>home_scores <span class="ot">&lt;-</span> <span class="fu">split_score</span>(match_recent<span class="sc">$</span>Home_Score)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>away_scores <span class="ot">&lt;-</span> <span class="fu">split_score</span>(match_recent<span class="sc">$</span>Away_Score)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>match_clean <span class="ot">&lt;-</span> match_recent <span class="sc">|&gt;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    home_scores <span class="sc">|&gt;</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">Home_Goals =</span> Goals, <span class="at">Home_Behinds =</span> Behinds, <span class="at">Home_Total =</span> Total),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    away_scores <span class="sc">|&gt;</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">Away_Goals =</span> Goals, <span class="at">Away_Behinds =</span> Behinds, <span class="at">Away_Total =</span> Total)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="8" type="1">
<li>Create new variables to indicate whether the home team won and team is in the final round or not.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>match_clean <span class="ot">&lt;-</span> match_clean <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Home_Win =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      Home_Total <span class="sc">&gt;</span> Away_Total <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      Home_Total <span class="sc">&lt;</span> Away_Total <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span>  <span class="co"># for draws</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Match_Finals =</span> Round <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"EF"</span>, <span class="st">"QF"</span>, <span class="st">"SF"</span>, <span class="st">"PF"</span>, <span class="st">"GF"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="9" type="1">
<li>Select relevant columns for analysis.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>final_matches <span class="ot">&lt;-</span> match_clean <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Match_No,Year, Date, Round, Venue,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         Home_Team, Home_Total,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         Away_Team, Away_Total,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         Home_Win, Match_Finals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="references" class="level6">
<h6 class="anchored" data-anchor-id="references"><strong>References</strong></h6>
<p>Wickham H, François R, Henry L, Müller K, Vaughan D (2023). <em>dplyr: A Grammar of Data Manipulation</em>. R package version 1.1.4, <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a>.</p>
<p>Wickham H (2023). <em>stringr: Simple, Consistent Wrappers for Common String Operations</em>. R package version 1.5.1, <a href="https://CRAN.R-project.org/package=stringr" class="uri">https://CRAN.R-project.org/package=stringr</a>.</p>
<p>Müller K, Wickham H (2023). <em>tibble: Simple Data Frames</em>. R package version 3.2.1, <a href="https://CRAN.R-project.org/package=tibble" class="uri">https://CRAN.R-project.org/package=tibble</a>.</p>
<p>Garrett Grolemund, Hadley Wickham (2011). Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1-25. URL https://www.jstatsoft.org/v40/i03/.</p>
<!-- Task 2 Tab: Writing your blogpost -->
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="has-home-ground-advantage-significantly-affected-match-outcomes-over-the-past-decade-of-afl-from-2014-to-2024." class="level3">
<h3 class="anchored" data-anchor-id="has-home-ground-advantage-significantly-affected-match-outcomes-over-the-past-decade-of-afl-from-2014-to-2024.">Has home ground advantage significantly affected match outcomes over the past decade of AFL from 2014 to 2024.</h3>
<p><strong><em>“Home ground advantage”</em></strong> <strong>refers to the belief that teams are more likely to win when they play at their traditional home venue, a concept deeply embedded in Australian Football League (AFL)</strong> <strong>culture and one of the most frequently debated ideas in sports.</strong> But does playing on your home turf still significantly affect outcomes in modern professional footy? With the rise of interstate teams, neutral venues, and structured finals systems, it’s worth investigating whether this long-held assumption still holds true. In this blog post, I analyse 10 seasons of AFL match data to explore three key questions:</p>
<ol type="1">
<li><p>Do teams win more often at home?</p></li>
<li><p>Has the impact of home ground advantage changed over time?</p></li>
<li><p>Does home advantage persist during finals?</p></li>
</ol>
<p>The dataset was sourced from AFL Tables, which records every AFL game played since 1897. I filtered matches from 2014 to 2024 and parsed match details such as date, round, home and away teams, scores, and venues. Scores were broken down into goals, behinds, and total points, and I create new variables like Home_Win and Match_Finals to enable targeted analysis.</p>
<p>The cleaned dataset allowed me to calculate win percentages, visualise trends over time, and compare performance between finals and regular season matches.</p>
<p><strong>Analysis</strong></p>
<p><strong>1. Home Win Rate by Team</strong></p>
<p>Home ground advantage is a widely discussed concept in the AFL, and this analysis helps quantify its impact over the past decade. The chart shows that some teams, such as Geelong and Port Adelaide, have consistently won more than 50% of their home games, suggesting a strong advantage when playing on familiar turf. In contrast, other teams, including Carlton and North Melbourne, have struggled to achieve similar success at home.</p>
<p>These differences may be influenced by other factors such as weather, crowd support, etc.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_Sumintra_Boonmat_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>2. Home Win Rate Across Time</strong></p>
<p>An annual analysis of home win rates from 2014 to 2024 shows that home ground advantage has remained relatively stable, with win rates consistently above 50%. Most years fall within the 52–59% range, with peaks in 2016 and 2022 reaching around 59%. The lowest point occurred in 2021, dipping to approximately 51%, likely due to lingering COVID-19 disruptions. Overall, home teams have won more often than lost across every year, confirming that home ground advantage has been present and continues to play a meaningful role in match outcomes.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_Sumintra_Boonmat_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>3. Finals vs Regular Season Performance</strong></p>
<p>2014–2024 period:</p>
<ul>
<li><p>Home win rate in <strong>regular season games</strong>: ~53–54%</p></li>
<li><p>Home win rate in <strong>finals</strong>: ~55%</p></li>
</ul>
<p>This small but noticeable increase suggests that playing at home may offer a slight edge in finals, though the competitive nature of finals and use of shared venues like the MCG likely moderate this effect.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="assignment4_template_Sumintra_Boonmat_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusions</strong></p>
<ul>
<li><p><strong>Home ground advantage exists but is modest</strong>: Over the past 10 seasons, home teams have won slightly more than half of their matches.</p></li>
<li><p><strong>Team variation matters</strong>: Some teams benefit more from home conditions than others.</p></li>
<li><p><strong>Finals reduce the effect</strong>: High-stakes matches at shared venues tend to neutralise home-field benefits.</p></li>
</ul>
<p>These findings challenge the traditional view that home ground advantage is a dominant factor in AFL outcomes. For supporters, clubs, and analysts, it’s worth acknowledging that in today’s professional era, preparation and team quality may outweigh location.</p>
<p><strong>References</strong></p>
<p>AFL Tables. (n.d.). <em>AFL match results and statistics</em>. Retrieved from <a href="https://afltables.com/afl/afl_index.html" class="uri">https://afltables.com/afl/afl_index.html</a></p>
<!-- Task 3 Tab: Behind the Scenes -  -->
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<section id="question5-tell-us-about-parts-of-your-data-processing-or-analysis-that-werent-sexy-and-wouldnt-typically-be-included-in-a-blog-post.-e.g.-was-their-any-data-drudgery-or-time-intensive-wrangling-were-there-any-repetitive-tasks-or-manual-tasks-if-it-was-easy-describe-what-made-it-easy" class="level6">
<h6 class="anchored" data-anchor-id="question5-tell-us-about-parts-of-your-data-processing-or-analysis-that-werent-sexy-and-wouldnt-typically-be-included-in-a-blog-post.-e.g.-was-their-any-data-drudgery-or-time-intensive-wrangling-were-there-any-repetitive-tasks-or-manual-tasks-if-it-was-easy-describe-what-made-it-easy"><strong>Question5: Tell us about parts of your data processing or analysis that weren’t “sexy” and wouldn’t typically be included in a blog post. (e.g.&nbsp;Was their any data drudgery or time intensive wrangling? Were there any repetitive tasks or manual tasks? If it was easy, describe what made it easy?)</strong></h6>
<p>The time consuming part but important in this analysis was manually checking whether each team’s home ground matched the game location. This step was time-consuming but important, since correctly identifying true home games was key to the analysis. It wasn’t something that could be fully automated, and it required careful attention to detail.</p>
</section>
<section id="question6-were-there-any-challenges-that-you-faced-in-conducting-this-analysis.-these-may-take-the-form-of-data-limitations-or-coding-challenges-e.g.-was-there-anything-in-your-analysis-that-you-were-not-anticipating-when-you-started-did-you-have-to-change-your-intended-scope-did-you-need-to-master-a-new-skill-were-there-any-problems-you-were-proud-of-solving" class="level6">
<h6 class="anchored" data-anchor-id="question6-were-there-any-challenges-that-you-faced-in-conducting-this-analysis.-these-may-take-the-form-of-data-limitations-or-coding-challenges-e.g.-was-there-anything-in-your-analysis-that-you-were-not-anticipating-when-you-started-did-you-have-to-change-your-intended-scope-did-you-need-to-master-a-new-skill-were-there-any-problems-you-were-proud-of-solving"><strong>Question6: Were there any challenges that you faced in conducting this analysis. These may take the form of data limitations or coding challenges? (e.g.&nbsp;Was there anything in your analysis that you were not anticipating when you started? Did you have to change your intended scope? Did you need to master a new skill? Were there any problems you were proud of solving?)</strong></h6>
<p>One big challenge in this analysis was handling the long history of AFL data. Since the AFL premiership has run from 1897 to the present. Many things have changed, teams have joined, merged, or left, and stadiums have been renamed. This made it hard to keep team names and home grounds consistent over time.</p>
<p>To keep things clear, I focused only on the last 10 seasons (2014–2024), when the data was more stable and consistent. Figuring out which games were true home games (and not at shared or neutral venues) also took careful logic and sometimes manual checks.</p>
</section>
<section id="question7-tell-us-about-any-imperfect-parts-of-your-work-and-how-you-would-like-to-expand-or-improve-this-analysis-in-future-be-clear-about-any-limitations-or-aspects-of-your-analysis-that-fell-beyond-scope." class="level6">
<h6 class="anchored" data-anchor-id="question7-tell-us-about-any-imperfect-parts-of-your-work-and-how-you-would-like-to-expand-or-improve-this-analysis-in-future-be-clear-about-any-limitations-or-aspects-of-your-analysis-that-fell-beyond-scope."><strong>Question7: Tell us about any imperfect parts of your work and how you would like to expand or improve this analysis in future? Be clear about any limitations or aspects of your analysis that fell beyond scope.</strong></h6>
<p><strong>Limitations:</strong><br>
This analysis only looked at basic match results like wins and total points. It didn’t include other important factors like player injuries, crowd size, or weather, which could help explain the results more.</p>
<p><strong>Future Improvements:</strong><br>
Some venues like the MCG and Marvel Stadium are used as a home ground by more than one team, e.g., St Kilda and Essendon have Marvel Stadium as their home venue, so it’s harder to tell which team really has the home advantage. For future improvement, we could consider things like bye rounds, how familiar teams are with the venue, and how the crowd is split between teams.</p>
</section>
<section id="question8-also-submit-4-earlier-versions-of-your-assignment-that-show-your-iterative-process.-these-should-be-your-messy-versions-and-include-exploratory-code.-we-recommend-you-save-these-files-as-you-progress-through-your-assignment.-provide-a-short-overview-for-markers-of-what-you-fixedlearntimprovedchanged-between-each-file.-if-you-are-comfortable-with-github-you-may-submit-your-github-repo-but-please-refer-to-individual-commits." class="level6">
<h6 class="anchored" data-anchor-id="question8-also-submit-4-earlier-versions-of-your-assignment-that-show-your-iterative-process.-these-should-be-your-messy-versions-and-include-exploratory-code.-we-recommend-you-save-these-files-as-you-progress-through-your-assignment.-provide-a-short-overview-for-markers-of-what-you-fixedlearntimprovedchanged-between-each-file.-if-you-are-comfortable-with-github-you-may-submit-your-github-repo-but-please-refer-to-individual-commits."><strong>Question8: Also submit 4 earlier versions of your assignment that show your iterative process. These should be your messy versions and include exploratory code. We recommend you save these files as you progress through your assignment. Provide a short overview for markers of what you fixed/learnt/improved/changed between each file. (If you are comfortable with GitHub you may submit your Github repo, but please refer to individual commits.)</strong></h6>
<p>I use <a href="https://github.com/SumintraB/etc5512-assignment4">GitHub</a> to record my workflow history:</p>
<ul>
<li><strong>3db1d6a</strong>: added task 1 - Imported the data, data cleaning.</li>
<li><strong>db96c74</strong>: added task2 - Write blog post and calculated and visualized win rates.</li>
<li><strong>29d7421</strong>: added task 3 - Behind the scenes details added.</li>
<li>- Final version of the analysis.</li>
</ul>
</section>
</div>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>